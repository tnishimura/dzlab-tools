#!/usr/bin/env perl
use strict;
use warnings;
use 5.010_000;
use Data::Dumper;
use autodie;
use Test::More qw(no_plan);
use Test::Exception;

BEGIN {
    use_ok "Eland::Statistics";
}

my ($total_count, $nm_count, $stats) = Eland::Statistics::eland_single_stat(\*DATA);

is($total_count, 100, "total count");
is($nm_count, 64, "nm count");
is_deeply($stats,
    {
        'chr3' => { '0' => 4 },
        'chr1' => { '0' => 8 },
        'chr4' => { '0' => 5 },
        'chrc' => { '0' => 17 },
        'chr2' => { '0' => 3 },
        'chr5' => { '0' => 9 }
    },
    "stats deeply");

__DATA__
HS1:137:C0B9KACXX:5:1101:1235:2144#/1	TNGGNNNNNNNNNNNNNNNNNNNNNNNNNN	NM	
HS1:137:C0B9KACXX:5:1101:1233:2190#/1	AATNNNNNNNNNNNNNNNNNNNNNNNNNNN	NM	
HS1:137:C0B9KACXX:5:1101:1248:2226#/1	TGGTNNNNNNNNNNNNNNNNNNNNNNNNNN	NM	
HS1:137:C0B9KACXX:5:1101:1395:2122#/1	TNTCGGGTTCGAGGAATTGTTGAGAAAAGT	NM	
HS1:137:C0B9KACXX:5:1101:1348:2124#/1	GNTATTTATTTTTTTATTTTATTNATTATA	NM	
HS1:137:C0B9KACXX:5:1101:1318:2130#/1	TNAGATNNNNNNNNNNNNNNNNNNNNNNNN	NM	
HS1:137:C0B9KACXX:5:1101:1281:2132#/1	TNATTGNNNNNNNNNNNNNNNNNNNNNNNN	NM	
HS1:137:C0B9KACXX:5:1101:1487:2135#/1	ANATTTTATATAGTATGAGTATAAGTAAAA	NM	
HS1:137:C0B9KACXX:5:1101:1365:2142#/1	TNAGATTTTGAAAGGGTTTGCGGGGATTAT	NM	
HS1:137:C0B9KACXX:5:1101:1423:2147#/1	GNGTGTTATATTGATGTATTTAATGAGTTT	NM	
HS1:137:C0B9KACXX:5:1101:1452:2152#/1	ANTTATAAAAGAAATATTTTGTTTGTTTTA	NM	
HS1:137:C0B9KACXX:5:1101:1255:2159#/1	GNTTNTNNNNNNNNNNNNNNNNNNNNNNNN	NM	
HS1:137:C0B9KACXX:5:1101:1346:2162#/1	ANAATTAGATTATAATAATAGNGNTAGTTG	NM	
HS1:137:C0B9KACXX:5:1101:1491:2169#/1	ANTAAGTTATAATTAAATATAATTAATTGT	NM	
HS1:137:C0B9KACXX:5:1101:1411:2170#/1	TNAATTAATAAGATATTGATTTAGAAAGAA	NM	
HS1:137:C0B9KACXX:5:1101:1329:2173#/1	ATTTTAAANTNNNNNTNNNNNNNNNNNNNN	NM	
HS1:137:C0B9KACXX:5:1101:1392:2175#/1	TATGGTGTAGTTAAAGTTTATATGAGTTTT	NM	
HS1:137:C0B9KACXX:5:1101:1299:2191#/1	TTTAAANNNNNNNNNNNNNNNNNNNNNNNN	NM	
HS1:137:C0B9KACXX:5:1101:1491:2192#/1	GTATGAGAGGAATTGTTGATTTGTATAATT	2:0:0:0	chr2:9155F0,chr3:14214112F0
HS1:137:C0B9KACXX:5:1101:1330:2197#/1	AATTGGTTNANANANANNNNNNNNNNNNNN	NM	
HS1:137:C0B9KACXX:5:1101:1458:2202#/1	GTTTGTTTTGAATTTTTTTGAAGATTAATT	NM	
HS1:137:C0B9KACXX:5:1101:1270:2209#/1	ATTGTTNNNNNNNNNNNNNNNNNNNNNNNN	NM	
HS1:137:C0B9KACXX:5:1101:1434:2211#/1	GAATTAGAATTATTTGAGTAATTATTATTA	1:0:0:0	RC_chr5:16778301F0
HS1:137:C0B9KACXX:5:1101:1393:2217#/1	GTTTTTTAGATAAATTTTATAGAGAATTTA	1:0:0:0	RC_chr3:18359778F0
HS1:137:C0B9KACXX:5:1101:1305:2220#/1	AAAATTNNNNNNNNNNNNNNNNNNNNNNNN	NM	
HS1:137:C0B9KACXX:5:1101:1487:2222#/1	TAAGGGAAATATAAGAAATATTATTATATA	1:0:0:0	chr4:6240217F0
HS1:137:C0B9KACXX:5:1101:1338:2226#/1	TTGACGGAAAAATTCGATTNNNNNGNNNTG	NM	
HS1:137:C0B9KACXX:5:1101:1453:2233#/1	GTATTTAAATATTTTATATTTTTATAAATT	1:0:0:0	RC_chr5:9545735F0
HS1:137:C0B9KACXX:5:1101:1415:2238#/1	AAATAATGATTTTTTTAGATGTATTGTATA	1:0:0:0	chr1:3790685F0
HS1:137:C0B9KACXX:5:1101:1606:2122#/1	TNAGGGGTTTGTTGTTGTTTTTTTTTAATA	NM	
HS1:137:C0B9KACXX:5:1101:1508:2127#/1	ANTTATTTTTAGTTTTAGTTTGAATAAAGT	NM	
HS1:137:C0B9KACXX:5:1101:1559:2133#/1	ANAATTAAATTTAAGGTAAAAATAGTTATT	NM	
HS1:137:C0B9KACXX:5:1101:1747:2135#/1	ANTAAGGATATATTATTTAGGTTTATAAGA	NM	
HS1:137:C0B9KACXX:5:1101:1641:2140#/1	ANGATTTGGAATAAAAGTAAGTAAAGGTTT	NM	
HS1:137:C0B9KACXX:5:1101:1598:2152#/1	GNTAAAGTTCGTATGATTTTTTGGTTTTGT	NM	
HS1:137:C0B9KACXX:5:1101:1525:2154#/1	TNTTTTTGGAATGGTTTTGGTGGTATGGTT	NM	
HS1:137:C0B9KACXX:5:1101:1661:2158#/1	ANTTTAATTAGAAATTAATTGAAAGAAAAA	NM	
HS1:137:C0B9KACXX:5:1101:1745:2162#/1	TNTAAAATTTTGATTGTTTTTGATTGTTTG	NM	
HS1:137:C0B9KACXX:5:1101:1598:2167#/1	TNTTATTAGTAATGAGGATTTGGAATATTA	NM	
HS1:137:C0B9KACXX:5:1101:1685:2169#/1	GNTTTTTGTTTATTTTTAATATAAATTGAT	NM	
HS1:137:C0B9KACXX:5:1101:1708:2173#/1	ANGATTTAGATTTGTTGTTTGGGAAATTTA	NM	
HS1:137:C0B9KACXX:5:1101:1550:2175#/1	TTGTTGAAAGGTGTTTTATTTGTTTGTAGT	1:0:0:0	RC_chrc:114263F0
HS1:137:C0B9KACXX:5:1101:1674:2183#/1	AAATAATGGAATTTTTTGTTGTTTGATTAA	1:0:0:0	chrc:49880F0
HS1:137:C0B9KACXX:5:1101:1698:2195#/1	AGTTTTGTTTAAAAAGATTAAAAGATTTAT	NM	
HS1:137:C0B9KACXX:5:1101:1626:2196#/1	ATATGGATGGAATATAATGAAATAGAGTTG	2:0:0:0	RC_chrc:45225F0,chrc:129395F0
HS1:137:C0B9KACXX:5:1101:1728:2203#/1	ATAATTTTGGATTTTTTGTTTTTTTGTATG	1:0:0:0	RC_chr4:18473334F0
HS1:137:C0B9KACXX:5:1101:1536:2204#/1	AATGTGTTTTATTTATATAGGGGATTTTTT	2:0:0:0	chrc:144839F0,RC_chrc:60669F0
HS1:137:C0B9KACXX:5:1101:1592:2212#/1	TTAATAAAGGGATAGAAATTGATTTGTTTT	1:0:0:0	RC_chr4:1245893F0
HS1:137:C0B9KACXX:5:1101:1674:2214#/1	GAGAGTGGGATATAATTAATCTGTGATTGG	1:0:0:0	chr1:24460109F0
HS1:137:C0B9KACXX:5:1101:1696:2231#/1	ATGAAAATTAAATAATAATTAAGAGTAAGA	1:0:0:0	RC_chr5:3971724F0
HS1:137:C0B9KACXX:5:1101:1553:2231#/1	TAAAGGAGGTTTATTTTTTTTAGAGTGTTG	1:0:0:0	chr4:12548457F0
HS1:137:C0B9KACXX:5:1101:1519:2233#/1	ATTTTTTCTGGTTTGTTCTTAAGTTGATTT	1:0:0:0	RC_chr1:3600159F0
HS1:137:C0B9KACXX:5:1101:1670:2242#/1	GGAATTTATATATATATTGTTTGTTAAGAT	2:0:0:0	RC_chr5:15209628F0,chrc:19292F0
HS1:137:C0B9KACXX:5:1101:1942:2123#/1	ANTATTTATATTAAATGGGTTATATTTATT	NM	
HS1:137:C0B9KACXX:5:1101:1836:2123#/1	ANTTTATATTGAGGTATTGATGGTGATTTT	NM	
HS1:137:C0B9KACXX:5:1101:1896:2124#/1	TNTATAGTAATGAGTTAATTTTATTATTTA	NM	
HS1:137:C0B9KACXX:5:1101:1978:2135#/1	TNATAAAATTTTAGGAGGTGTAAAAAATGA	NM	
HS1:137:C0B9KACXX:5:1101:1813:2145#/1	CNATGGGAGTTAATGGATCGACGGGATTTG	NM	
HS1:137:C0B9KACXX:5:1101:1906:2151#/1	GNTCGGAAGAGCGGTTCAGCAGGAATGCCG	NM	
HS1:137:C0B9KACXX:5:1101:1852:2161#/1	TNCGTTTTTTATTTTGTCTGTCTAAAATAG	NM	
HS1:137:C0B9KACXX:5:1101:1788:2166#/1	TNAATGAGTTAATAATAATTTTGTTATATT	NM	
HS1:137:C0B9KACXX:5:1101:1988:2169#/1	ANAAGAGAGTATTATTAGAATTATATAGAG	NM	
HS1:137:C0B9KACXX:5:1101:1901:2169#/1	TNGTATTTTGTTGAATTGTTTTTTTTATTA	NM	
HS1:137:C0B9KACXX:5:1101:1955:2184#/1	GAAATGTATTTTGTTTTATATATGAAAATA	1:0:0:0	RC_chr2:446373F0
HS1:137:C0B9KACXX:5:1101:1926:2189#/1	GGGTTTACGTTTTTGGCGGGAAAATTACGG	NM	
HS1:137:C0B9KACXX:5:1101:1876:2189#/1	TATATTTTGTAAATAATGAATTGAGTTTGT	1:0:0:0	chrc:69491F0
HS1:137:C0B9KACXX:5:1101:1753:2196#/1	TGGTGTTTTTGTTGAATTGTTTTTTTGATT	NM	
HS1:137:C0B9KACXX:5:1101:1833:2197#/1	TACGAAATTTTTTAGTGATAGTGAAATATA	1:0:0:0	chr5:13367704F0
HS1:137:C0B9KACXX:5:1101:1902:2200#/1	AAATAGATTATGTATTTTTAATGGTTAAAT	1:0:0:0	RC_chr3:8404725F0
HS1:137:C0B9KACXX:5:1101:1763:2211#/1	TAGTTGTATATAAAAGATAATGTTAAATGT	1:0:0:0	chr1:6497522F0
HS1:137:C0B9KACXX:5:1101:1877:2219#/1	ATTATTTATTTATTTTGATGTTTATATTTA	1:0:0:0	RC_chr1:16427694F0
HS1:137:C0B9KACXX:5:1101:1801:2224#/1	TATTTGTAAAGAATTTTTGATGTGAAAATA	2:0:0:0	chrc:145590F0,RC_chrc:61420F0
HS1:137:C0B9KACXX:5:1101:1848:2231#/1	AAGGATGGTTTTCAGTGATACAGAAGGGAC	1:0:0:0	chr4:3630608F0
HS1:137:C0B9KACXX:5:1101:1929:2238#/1	TTATAATTTTTTTTTTAGTTTTTAAGGAAT	1:0:0:0	chr3:4955002F0
HS1:137:C0B9KACXX:5:1101:1989:2239#/1	TAATAGATTTGAATATTTGTTTTAGATTGA	1:0:0:0	RC_chrc:112424F0
HS1:137:C0B9KACXX:5:1101:1819:2245#/1	ATAAGTTAGTAGTTGTTGATGTTTTTTTAG	1:0:0:0	chrc:123371F0
HS1:137:C0B9KACXX:5:1101:1782:2249#/1	TAAAGTAAAAGAAAGGGTTGATTATTTTAA	1:0:0:0	RC_chrc:124770F0
HS1:137:C0B9KACXX:5:1101:2047:2123#/1	TNTATAAAGTAGTTAATGATTATATTTGAA	NM	
HS1:137:C0B9KACXX:5:1101:2202:2124#/1	ANAAATAGAAGTATGTTTTGTTTATTAATA	NM	
HS1:137:C0B9KACXX:5:1101:2150:2130#/1	ANTAATGAGTATATGAAGGGTGTATTTGGT	NM	
HS1:137:C0B9KACXX:5:1101:2225:2132#/1	ANTGGGATTTAAAAGAAATTTGGGTATTTA	NM	
HS1:137:C0B9KACXX:5:1101:2095:2146#/1	ANATTAATTAAGATATAGATTTAATGTGAT	NM	
HS1:137:C0B9KACXX:5:1101:2033:2149#/1	TNGGTTGAGATTTAAAATTATTTTGTTTTT	NM	
HS1:137:C0B9KACXX:5:1101:2178:2150#/1	GNGTTTTGGTGGTGGAAATTGTAAATTTGG	NM	
HS1:137:C0B9KACXX:5:1101:2149:2154#/1	TNTAATAGTATATTATTAGGTATTATATGA	NM	
HS1:137:C0B9KACXX:5:1101:2123:2156#/1	TNGTTTTTTGAGTAATGTTATTAGTTTTTG	NM	
HS1:137:C0B9KACXX:5:1101:2231:2163#/1	ANATCTATAGATTGTTTTTGCAGTAATTCC	NM	
HS1:137:C0B9KACXX:5:1101:2187:2171#/1	ANTTGAATTTTAATTTAAATGGATAAATTT	NM	
HS1:137:C0B9KACXX:5:1101:2067:2173#/1	TNAATTGAATGAGATTTTTTATAGATTTTT	NM	
HS1:137:C0B9KACXX:5:1101:2148:2174#/1	ANTATTTTTTTAATTTTTTTTTAGTAGAAT	NM	
HS1:137:C0B9KACXX:5:1101:2122:2182#/1	ATAATAGAAAAGAAAAGAATTGTTTTTTTT	3:0:0:0	chr2:2938415F0,chrc:138848F0,RC_chrc:54678F0
HS1:137:C0B9KACXX:5:1101:2225:2196#/1	TATATAAAGTATGTTTTAGTTTTATTTATG	3:0:0:0	RC_chr5:11293260F0,RC_chr5:11306824F0,RC_chr5:11319354F0
HS1:137:C0B9KACXX:5:1101:2141:2197#/1	AAAGAATTTTTGATGTGAAAATATAGAGAT	2:0:0:0	chrc:145597F0,RC_chrc:61427F0
HS1:137:C0B9KACXX:5:1101:2166:2198#/1	ATTTTTATTAATAAAATTTTAAATTTGAAA	1:0:0:0	RC_chr1:20400628F0
HS1:137:C0B9KACXX:5:1101:2246:2204#/1	TGGTATTTTTGTTGAATTGTTTTTTTGATT	NM	
HS1:137:C0B9KACXX:5:1101:2033:2205#/1	AACAGATGTTTTTAAATTATAAAGGTATTT	NM	
HS1:137:C0B9KACXX:5:1101:2117:2212#/1	GTGGAAAAAATTTAGTTTTTTTTAGAGAAA	1:0:0:0	RC_chr1:8367988F0
HS1:137:C0B9KACXX:5:1101:2211:2218#/1	TTGCGATCGTTAATTGTTAGTTTTTTTAGG	1:0:0:0	RC_chr5:13904478F0
HS1:137:C0B9KACXX:5:1101:2072:2222#/1	TGGATGTGATAAGGTTTTATTATTAATATA	1:0:0:0	RC_chr1:14394903F0
HS1:137:C0B9KACXX:5:1101:2181:2223#/1	GTTGTTTGATATGATTGTGTGTGGTGTGTT	NM	
